# Makefile pour projet Symfony + Docker unifié à la racine

# Lancer les conteneurs en arrière-plan avec build
up:
	docker compose up -d --build

# Arrêter les conteneurs
down:
	docker compose down

# Redémarrer proprement en supprimant les volumes (base de données, etc.)
reset:
	docker compose down -v
	docker compose up -d --build

# Accéder à un shell bash dans le conteneur web
bash:
	docker exec -it symfony_web bash

# Installer les dépendances PHP (dans le conteneur)
composer-install:
	docker exec -it symfony_web composer install

# Créer la base de données
db-create:
	docker exec -it symfony_web php bin/console doctrine:database:create

# Lancer les migrations
migrate:
	docker exec -it symfony_web php bin/console doctrine:migrations:migrate

# Exécuter les tests PHPUnit
test:
	docker exec -it symfony_web php bin/phpunit

# Installer les dépendances JS (sur la machine hôte)
yarn-install:
	yarn install

# Compiler les assets (production)
build:
	yarn build

# Lancer le serveur de dev Webpack Encore (avec hot reload)
dev-server:
	yarn dev-server

# Initialisation complète (PHP + JS + DB)
init: up composer-install yarn-install db-create migrate build